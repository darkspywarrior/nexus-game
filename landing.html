<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nexus - Play, Stream, Connect</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html, #app {
      margin: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    body {
      touch-action: none;
      font-family: "Montserrat", sans-serif;
      background: radial-gradient(circle at center, #0a0a0a 0%, #000000 100%);
      overflow: hidden;
    }

    #app {
      height: 100vh;
      position: relative;
    }

    #app a {
      text-decoration: none;
      color: #fff;
      opacity: 0;
      animation: fadeInUp 1s ease-out 6s forwards;
    }

    #canvas {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      overflow: hidden;
      z-index: 1;
      background: radial-gradient(ellipse at center, #0a0a0a 0%, #000000 100%);
      opacity: 1;
    }

    .hero {
      position: relative;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
      z-index: 10;
      background: radial-gradient(ellipse at center, rgba(255, 0, 128, 0.1) 0%, rgba(0, 255, 159, 0.05) 25%, rgba(153, 102, 255, 0.1) 50%, rgba(255, 222, 89, 0.05) 75%, rgba(0, 0, 0, 0.8) 100%);
      backdrop-filter: blur(2px);
      opacity: 0;
      transform: translateY(50px);
      animation: fadeInUp 1s ease-out 3s forwards;
    }

    h1, h2, p {
      margin: 0;
      padding: 0;
      color: white;
      text-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
      line-height: 100%;
      user-select: none;
    }

    h1 {
      font-size: 4rem;
      font-weight: 700;
      text-transform: uppercase;
      margin-bottom: 10px;
      background: linear-gradient(45deg, #ff0080, #00ff9f, #9966ff, #ffde59, #ff3366, #33ccff);
      background-size: 400% 400%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 3s ease-in-out infinite;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease-out 4s forwards, gradientShift 3s ease-in-out 4.5s infinite;
    }

    h2 {
      font-size: 2.5rem;
      font-weight: 500;
      text-transform: uppercase;
      margin-bottom: 20px;
      background: linear-gradient(45deg, #33ccff, #ff6600, #cc00ff);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 3s ease-in-out infinite;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease-out 4.5s forwards, gradientShift 3s ease-in-out 5s infinite;
    }

    .subtitle {
      font-size: 1.4rem;
      color: #e0e0e0;
      text-align: center;
      max-width: 700px;
      line-height: 1.6;
      margin-bottom: 40px;
      font-weight: 300;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease-out 5s forwards;
    }

    .auth-buttons {
      display: flex;
      gap: 20px;
      margin-top: 30px;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease-out 5.5s forwards;
    }

    .btn {
      padding: 15px 35px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }

    .btn-secondary {
      background: transparent;
      color: #ffffff;
      border: 2px solid #ff0080;
      box-shadow: 0 8px 25px rgba(255, 0, 128, 0.2);
    }

    .btn-secondary:hover {
      background: rgba(255, 0, 128, 0.1);
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(255, 0, 128, 0.3);
    }

    .btn-primary {
      background: linear-gradient(135deg, #ff0080, #00ff9f, #9966ff);
      color: white;
      box-shadow: 0 8px 25px rgba(255, 0, 128, 0.3);
      border: none;
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(255, 0, 128, 0.4);
    }

    .btn-google {
      background: #ffffff;
      color: #333333;
      border: 2px solid #e0e0e0;
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 500;
    }

    .btn-google:hover {
      background: #f8f9fa;
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.1);
    }

    .btn-google img {
      width: 20px;
      height: 20px;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, rgba(255, 0, 128, 0.1) 0%, rgba(0, 255, 159, 0.05) 25%, rgba(153, 102, 255, 0.1) 50%, rgba(0, 0, 0, 0.95) 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s ease;
      backdrop-filter: blur(5px);
    }

    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .loading-spinner {
      width: 80px;
      height: 80px;
      border: 4px solid rgba(255, 0, 128, 0.2);
      border-top: 4px solid #ff0080;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 30px;
      box-shadow: 0 8px 25px rgba(255, 0, 128, 0.3);
    }

    .loading-text {
      color: #ffffff;
      font-size: 1.8rem;
      font-weight: 600;
      text-align: center;
      animation: pulse 2s ease-in-out infinite;
    }

    .loading-dots::after {
      content: '...';
      display: inline-block;
      animation: dots 1.5s steps(4, end) infinite;
    }

    @keyframes dots {
      0% { content: '.'; }
      25% { content: '..'; }
      50% { content: '...'; }
      75% { content: '..'; }
    }

    .intro-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 1;
      animation: introFadeOut 1s ease-out 2s forwards;
    }

    .intro-text {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(45deg, #ff0080, #00ff9f, #9966ff, #ffde59, #ff3366);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 8px;
      animation: gradientShift 2s ease-in-out infinite;
      margin-bottom: 20px;
    }

    .intro-subtitle {
      color: #ffffff;
      font-size: 1.2rem;
      font-weight: 300;
      opacity: 0;
      animation: fadeInUp 1s ease-out 1s forwards;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: linear-gradient(135deg, rgba(20, 20, 25, 0.95), rgba(15, 15, 20, 0.98));
      border-radius: 24px;
      padding: 2px;
      width: 90%;
      max-width: 450px;
      position: relative;
      transform: scale(0.8) translateY(50px);
      transition: all 0.3s ease;
    }

    .modal-overlay.active .modal {
      transform: scale(1) translateY(0);
    }

    .modal-inner {
      position: relative;
      background: rgba(20, 20, 25, 0.95);
      border-radius: 24px;
      padding: 40px;
      height: 100%;
    }

    .modal-border-outer {
      border: 2px solid rgba(221, 132, 72, 0.5);
      border-radius: 24px;
      padding-right: 4px;
      padding-bottom: 4px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .modal-main-card {
      border: 2px solid #dd8448;
      border-radius: 24px;
      margin-top: -4px;
      margin-left: -4px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      filter: url(#turbulent-displace);
    }

    .modal-glow-layer-1 {
      border: 2px solid rgba(221, 132, 72, 0.6);
      border-radius: 24px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      filter: blur(1px);
    }

    .modal-glow-layer-2 {
      border: 2px solid #dd8448;
      border-radius: 24px;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      filter: blur(4px);
    }

    .modal-overlay-1 {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 24px;
      opacity: 1;
      mix-blend-mode: overlay;
      transform: scale(1.1);
      filter: blur(16px);
      background: linear-gradient(-30deg, white, transparent 30%, transparent 70%, white);
    }

    .modal-overlay-2 {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 24px;
      opacity: 0.5;
      mix-blend-mode: overlay;
      transform: scale(1.1);
      filter: blur(16px);
      background: linear-gradient(-30deg, white, transparent 30%, transparent 70%, white);
    }

    .modal-background-glow {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 24px;
      filter: blur(32px);
      transform: scale(1.1);
      opacity: 0.3;
      z-index: -1;
      background: linear-gradient(-30deg, #dd8448, transparent, #dd8448);
    }

    .modal-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .modal-title {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(45deg, #ff0080, #00ff9f, #9966ff);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 3s ease-in-out infinite;
      margin-bottom: 10px;
    }

    .modal-subtitle {
      color: #a0a0a0;
      font-size: 1rem;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      color: #ffffff;
      font-weight: 500;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .form-input {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      color: #ffffff;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #ff0080;
      box-shadow: 0 0 20px rgba(255, 0, 128, 0.3);
    }

    .form-input::placeholder {
      color: #666666;
    }

    .modal-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }

    .modal-buttons .btn {
      width: 100%;
      justify-content: center;
    }

    .modal-footer {
      text-align: center;
      margin-top: 20px;
    }

    .modal-link {
      color: #ff0080;
      text-decoration: none;
      font-weight: 500;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .modal-link:hover {
      color: #00ff9f;
    }

    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: #666666;
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: #ffffff;
    }

    .otp-container {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }

    .otp-input {
      width: 50px;
      height: 50px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      color: #ffffff;
      transition: all 0.3s ease;
    }

    .otp-input:focus {
      outline: none;
      border-color: #ff0080;
      box-shadow: 0 0 15px rgba(255, 0, 128, 0.3);
    }

    .otp-input.filled {
      border-color: #00ff9f;
      background: rgba(0, 255, 159, 0.1);
    }

    .resend-btn {
      background: none;
      border: none;
      color: #ff0080;
      cursor: pointer;
      font-size: 0.9rem;
      text-decoration: underline;
      margin-top: 10px;
    }

    .resend-btn:hover {
      color: #00ff9f;
    }

    .success-message {
      text-align: center;
      color: #00ff9f;
      font-weight: 500;
      margin-top: 20px;
      display: none;
    }

    .error-message {
      text-align: center;
      color: #ff3366;
      font-weight: 500;
      margin-top: 20px;
      display: none;
    }

    .country-code {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .country-select {
      padding: 15px;
      border: 2px solid #ff0080;
      border-radius: 12px;
      background: rgba(255, 0, 128, 0.1);
      color: #ffffff;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
      width: 100px; /* Fixed width for consistency */
    }

    .country-select:focus {
      outline: none;
      border-color: #00ff9f;
      box-shadow: 0 0 20px rgba(0, 255, 159, 0.3);
    }

    .country-select option {
      background: #1a1a1a;
      color: #ffffff;
      font-size: 1rem;
      padding: 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    @keyframes introFadeOut {
      0% { opacity: 1; visibility: visible; }
      100% { opacity: 0; visibility: hidden; }
    }

    @media (max-width: 768px) {
      h1 { font-size: 2.5rem; }
      h2 { font-size: 1.5rem; }
      .auth-buttons {
        flex-direction: column;
        gap: 15px;
        width: 100%;
        max-width: 300px;
      }
      .btn {
        width: 100%;
        padding: 18px 25px;
      }
      .subtitle {
        font-size: 1rem;
        padding: 0 20px;
      }
    }
  </style>
</head>
<body>
  <!-- SVG Filter for Electric Border Effect -->
  <svg class="svg-container" style="position: absolute; width: 0; height: 0;">
    <defs>
      <filter id="turbulent-displace" colorInterpolationFilters="sRGB" x="-20%" y="-20%" width="140%" height="140%">
        <feTurbulence type="turbulence" baseFrequency="0.02" numOctaves="10" result="noise1" seed="1" />
        <feOffset in="noise1" dx="0" dy="0" result="offsetNoise1">
          <animate attributeName="dy" values="700; 0" dur="6s" repeatCount="indefinite" calcMode="linear" />
        </feOffset>
        <feTurbulence type="turbulence" baseFrequency="0.02" numOctaves="10" result="noise2" seed="1" />
        <feOffset in="noise2" dx="0" dy="0" result="offsetNoise2">
          <animate attributeName="dy" values="0; -700" dur="6s" repeatCount="indefinite" calcMode="linear" />
        </feOffset>
        <feTurbulence type="turbulence" baseFrequency="0.02" numOctaves="10" result="noise1" seed="2" />
        <feOffset in="noise1" dx="0" dy="0" result="offsetNoise3">
          <animate attributeName="dx" values="490; 0" dur="6s" repeatCount="indefinite" calcMode="linear" />
        </feOffset>
        <feTurbulence type="turbulence" baseFrequency="0.02" numOctaves="10" result="noise2" seed="2" />
        <feOffset in="noise2" dx="0" dy="0" result="offsetNoise4">
          <animate attributeName="dx" values="0; -490" dur="6s" repeatCount="indefinite" calcMode="linear" />
        </feOffset>
        <feComposite in="offsetNoise1" in2="offsetNoise2" result="part1" />
        <feComposite in="offsetNoise3" in2="offsetNoise4" result="part2" />
        <feBlend in="part1" in2="part2" mode="color-dodge" result="combinedNoise" />
        <feDisplacementMap in="SourceGraphic" in2="combinedNoise" scale="30" xChannelSelector="R" yChannelSelector="B" />
      </filter>
    </defs>
  </svg>

  <!-- Intro Overlay -->
  <div class="intro-overlay">
    <div class="intro-text">NEXUS</div>
    <div class="intro-subtitle">Loading Experience...</div>
  </div>

  <div id="app">
    <canvas id="canvas"></canvas>
    <div class="hero">
      <h1>Welcome to Nexus</h1>
      <h2>Play, Stream, Connect</h2>
      <p class="subtitle">
        Discover tournaments, streaming, and social gaming—all in one place.
        Play top games, build your profile, and connect instantly with players globally.
      </p>
      <div class="auth-buttons">
        <button class="btn btn-secondary" onclick="showLoading('login')">Login</button>
        <button class="btn btn-secondary" onclick="showLoading('signup')">Sign Up</button>
      </div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">
      Loading<span class="loading-dots"></span>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal-overlay" id="loginModal">
    <div class="modal">
      <div class="modal-border-outer">
        <div class="modal-main-card"></div>
      </div>
      <div class="modal-glow-layer-1"></div>
      <div class="modal-glow-layer-2"></div>
      <div class="modal-overlay-1"></div>
      <div class="modal-overlay-2"></div>
      <div class="modal-background-glow"></div>
      <div class="modal-inner">
        <button class="close-btn" onclick="closeModal('loginModal')">&times;</button>
        <div class="modal-header">
          <h2 class="modal-title">Welcome Back</h2>
          <p class="modal-subtitle">Sign in to your Nexus account (SMS rates may apply)</p>
        </div>
        <form id="loginForm">
          <div class="form-group country-code">
            <select class="country-select" id="loginCountryCode">
              <option value="+91">🇮🇳 India (+91)</option>
              <option value="+1">🇺🇸 United States (+1)</option>
              <option value="+44">🇬🇧 United Kingdom (+44)</option>
              <option value="+61">🇦🇺 Australia (+61)</option>
              <option value="+81">🇯🇵 Japan (+81)</option>
            </select>
            <input type="tel" class="form-input" placeholder="Enter your mobile number" id="loginMobile" required>
          </div>
          <div class="error-message" id="loginError"></div>
          <div class="modal-buttons">
            <button type="button" class="btn btn-google" onclick="googleSignIn()">
              <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google">
              Continue with Google
            </button>
            <button type="submit" class="btn btn-secondary">Send OTP</button>
          </div>
        </form>
        <div class="modal-footer">
          <p>Don't have an account? <span class="modal-link" onclick="switchModal('loginModal', 'signupModal')">Sign Up</span></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Signup Modal -->
  <div class="modal-overlay" id="signupModal">
    <div class="modal">
      <div class="modal-border-outer">
        <div class="modal-main-card"></div>
      </div>
      <div class="modal-glow-layer-1"></div>
      <div class="modal-glow-layer-2"></div>
      <div class="modal-overlay-1"></div>
      <div class="modal-overlay-2"></div>
      <div class="modal-background-glow"></div>
      <div class="modal-inner">
        <button class="close-btn" onclick="closeModal('signupModal')">&times;</button>
        <div class="modal-header">
          <h2 class="modal-title">Create Profile</h2>
          <p class="modal-subtitle">Join the Nexus gaming community (SMS rates may apply)</p>
        </div>
        <form id="signupForm">
          <div class="form-group">
            <label class="form-label">Full Name</label>
            <input type="text" class="form-input" placeholder="Enter your full name" id="signupName" required>
          </div>
          <div class="form-group country-code">
            <select class="country-select" id="signupCountryCode">
              <option value="+91">🇮🇳 India (+91)</option>
              <option value="+1">🇺🇸 United States (+1)</option>
              <option value="+44">🇬🇧 United Kingdom (+44)</option>
              <option value="+61">🇦🇺 Australia (+61)</option>
              <option value="+81">🇯🇵 Japan (+81)</option>
            </select>
            <input type="tel" class="form-input" placeholder="Enter your mobile number" id="signupMobile" required>
          </div>
          <div class="error-message" id="signupError"></div>
          <div class="modal-buttons">
            <button type="button" class="btn btn-google" onclick="googleSignUp()">
              <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google">
              Sign up with Google
            </button>
            <button type="submit" class="btn btn-secondary">Create Account</button>
          </div>
        </form>
        <div class="modal-footer">
          <p>Already have an account? <span class="modal-link" onclick="switchModal('signupModal', 'loginModal')">Sign In</span></p>
        </div>
      </div>
    </div>
  </div>

  <!-- OTP Verification Modal -->
  <div class="modal-overlay" id="otpModal">
    <div class="modal">
      <div class="modal-border-outer">
        <div class="modal-main-card"></div>
      </div>
      <div class="modal-glow-layer-1"></div>
      <div class="modal-glow-layer-2"></div>
      <div class="modal-overlay-1"></div>
      <div class="modal-overlay-2"></div>
      <div class="modal-background-glow"></div>
      <div class="modal-inner">
        <button class="close-btn" onclick="closeModal('otpModal')">&times;</button>
        <div class="modal-header">
          <h2 class="modal-title">Verify OTP</h2>
          <p class="modal-subtitle">Enter the 6-digit code sent to your mobile</p>
        </div>
        <div class="otp-container">
          <input type="text" class="otp-input" maxlength="1" data-index="0">
          <input type="text" class="otp-input" maxlength="1" data-index="1">
          <input type="text" class="otp-input" maxlength="1" data-index="2">
          <input type="text" class="otp-input" maxlength="1" data-index="3">
          <input type="text" class="otp-input" maxlength="1" data-index="4">
          <input type="text" class="otp-input" maxlength="1" data-index="5">
        </div>
        <div class="error-message" id="otpError"></div>
        <div class="success-message" id="otpSuccess"></div>
        <div class="modal-buttons">
          <button type="button" class="btn btn-primary" onclick="verifyOTP()">Verify OTP</button>
          <button type="button" class="resend-btn" onclick="resendOTP()">Resend OTP</button>
        </div>
      </div>
    </div>
  </div>

  <!-- reCAPTCHA Container -->
  <div id="recaptcha-container" style="display: none;"></div>

  <script type="module">
  // Firebase Imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
  import { 
    getAuth, 
    signInWithPopup, 
    GoogleAuthProvider, 
    signInWithPhoneNumber, 
    RecaptchaVerifier,
    signInAnonymously 
  } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
  import TubesCursor from "https://cdn.jsdelivr.net/npm/threejs-components@0.0.19/build/cursors/tubes1.min.js";

  // Firebase Configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDGGSaLwAMo-sRZ3kSfnnbQOvPnLW3qnew",
    authDomain: "nexus-play-f9754.firebaseapp.com",
    projectId: "nexus-play-f9754",
    storageBucket: "nexus-play-f9754.firebasestorage.app",
    messagingSenderId: "928982998155",
    appId: "1:928982998155:web:4cba3607579870d627888e",
    measurementId: "G-ZE0J6GB23D"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  let confirmationResult = null;
  let lastPhoneNumber = null;

  // === 3D CURSOR (unchanged) ===
  const tubesApp = TubesCursor(document.getElementById('canvas'), {
    tubes: {
      colors: ["#ff0080", "#00ff9f", "#9966ff", "#ffde59", "#ff3366"],
      lights: { intensity: 50, colors: ["#83f36e", "#fe8a2e", "#ff008a", "#60aed5"] },
      metalness: 0.05,
      roughness: 0.05,
      emissive: true,
      emissiveIntensity: 0.1
    },
    bloom: { enabled: true, threshold: 0.25, strength: 1.2, radius: 0.8 },
    camera: { position: [0, 0, 5], fov: 75 },
    renderer: { antialias: true, alpha: false, powerPreference: "high-performance" },
    postprocessing: { enabled: true, toneMappingExposure: 1.0 }
  });

  document.body.addEventListener('click', () => {
    const colors = randomBrightColors(5);
    const lightsColors = randomBrightColors(5);
    tubesApp.tubes.setColors(colors);
    tubesApp.tubes.setLightsColors(lightsColors);
  });

  function randomBrightColors(count) {
    const brightColors = [
      "#ff0080", "#00ff9f", "#9966ff", "#ffde59",
      "#33ccff", "#ff6600", "#cc00ff", "#00ffff", "#ffff00"
    ];
    return Array(count).fill().map(() => brightColors[Math.floor(Math.random() * brightColors.length)]);
  }

  // === INTRO + reCAPTCHA INIT ===
  let recaptchaVerifier;
  const initRecaptcha = async () => {
    if (recaptchaVerifier) return recaptchaVerifier;
    recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {
      size: 'invisible',
      callback: () => {},
      'expired-callback': () => {
        showError('loginError', 'reCAPTCHA expired. Try again.');
        showError('signupError', 'reCAPTCHA expired. Try again.');
      }
    });
    await recaptchaVerifier.render();
    return recaptchaVerifier;
  };

  window.addEventListener('load', async () => {
    const intro = document.querySelector('.intro-overlay');
    setTimeout(() => {
      intro.style.transition = 'opacity 1s ease';
      intro.style.opacity = '0';
      setTimeout(() => { intro.style.display = 'none'; }, 1200);
    }, 3000);

    // Pre-init reCAPTCHA
    try { await initRecaptcha(); } catch (e) { console.error(e); }
  });

  // === MODAL HELPERS ===
  window.showModal = id => document.getElementById(id).classList.add('active');
  window.closeModal = id => {
    const modal = document.getElementById(id);
    modal.classList.remove('active');
    if (id === 'loginModal') {
      document.getElementById('loginForm').reset();
      hideError('loginError');
    } else if (id === 'signupModal') {
      document.getElementById('signupForm').reset();
      hideError('signupError');
    } else if (id === 'otpModal') {
      document.querySelectorAll('.otp-input').forEach(i => { i.value = ''; i.classList.remove('filled'); });
      hideError('otpError');
      document.getElementById('otpSuccess').style.display = 'none';
    }
  };
  window.switchModal = (from, to) => { closeModal(from); setTimeout(() => showModal(to), 300); };

  // === ERROR / SUCCESS ===
  const hideError = id => { const el = document.getElementById(id); el.style.display = 'none'; el.textContent = ''; };
  const showError = (id, msg) => {
    const el = document.getElementById(id);
    el.textContent = msg;
    el.style.display = 'block';
    setTimeout(() => hideError(id), 6000);
  };

  // === LOADING OVERLAY ===
  const loading = document.getElementById('loadingOverlay');
  const loadingText = loading.querySelector('.loading-text');
  const showLoading = msg => {
    loadingText.innerHTML = msg + '<span class="loading-dots"></span>';
    loading.classList.add('active');
  };

  window.showLoading = action => {
    showLoading(`Processing ${action === 'login' ? 'Login' : 'Signup'}`);
    setTimeout(() => {
      loading.classList.remove('active');
      showModal(action === 'login' ? 'loginModal' : 'signupModal');
    }, 1000);
  };

  // === GOOGLE SIGN-IN ===
  const googleProvider = new GoogleAuthProvider();
  window.googleSignIn = async () => {
    showLoading('Signing in with Google');
    try {
      await signInWithPopup(auth, googleProvider);
      loading.classList.remove('active');
      closeModal('loginModal');
      location.href = 'home.html';
    } catch (e) {
      loading.classList.remove('active');
      showError('loginError', e.code === 'auth/too-many-requests' 
        ? 'Too many attempts. Wait a minute.' 
        : 'Google sign-in failed.');
    }
  };

  window.googleSignUp = async () => {
    showLoading('Creating account with Google');
    try {
      await signInWithPopup(auth, googleProvider);
      loading.classList.remove('active');
      closeModal('signupModal');
      location.href = 'home.html';
    } catch (e) {
      loading.classList.remove('active');
      showError('signupError', e.code === 'auth/too-many-requests' 
        ? 'Too many attempts. Wait a minute.' 
        : 'Google sign-up failed.');
    }
  };

  // === ANONYMOUS SIGN-IN (NEW) ===
  window.continueAsGuest = async () => {
    showLoading('Continuing as Guest');
    try {
      await signInAnonymously(auth);
      loading.classList.remove('active');
      closeModal('loginModal');
      closeModal('signupModal');
      location.href = 'home.html';
    } catch (e) {
      loading.classList.remove('active');
      showError('loginError', 'Guest access failed. Try again.');
    }
  };

  // === PHONE OTP ===
  window.sendOTP = async (mobile, countryCode, modalId, errorId) => {
    const phone = `${countryCode}${mobile.replace(/\D/g,'')}`;
    if (!/^\+\d{8,15}$/.test(phone)) {
      showError(errorId, 'Invalid mobile number.');
      return;
    }
    const verifier = await initRecaptcha();
    showLoading('Sending OTP');
    try {
      lastPhoneNumber = phone;
      confirmationResult = await signInWithPhoneNumber(auth, phone, verifier);
      loading.classList.remove('active');
      closeModal(modalId);
      setTimeout(() => showModal('otpModal'), 300);
    } catch (e) {
      loading.classList.remove('active');
      const msg = e.code === 'auth/too-many-requests' ? 'Too many requests. Wait.' :
                  e.code === 'auth/invalid-phone-number' ? 'Invalid phone format.' :
                  'Failed to send OTP.';
      showError(errorId, msg);
      verifier.render().then(id => grecaptcha.reset(id));
    }
  };

  window.verifyOTP = async () => {
    const code = Array.from(document.querySelectorAll('.otp-input')).map(i => i.value).join('');
    if (code.length !== 6) { showError('otpError', 'Enter 6-digit OTP.'); return; }
    showLoading('Verifying');
    try {
      await confirmationResult.confirm(code);
      loading.classList.remove('active');
      const success = document.getElementById('otpSuccess');
      success.textContent = 'OTP verified! Redirecting...';
      success.style.display = 'block';
      setTimeout(() => { closeModal('otpModal'); location.href = 'home.html'; }, 2000);
    } catch (e) {
      loading.classList.remove('active');
      showError('otpError', 'Invalid OTP.');
    }
  };

  let lastResend = 0;
  window.resendOTP = async () => {
    if (Date.now() - lastResend < 30000) {
      showError('otpError', 'Wait 30s before resending.');
      return;
    }
    lastResend = Date.now();
    if (!lastPhoneNumber) { showError('otpError', 'No phone number found.'); return; }
    const verifier = await initRecaptcha();
    showLoading('Resending');
    try {
      confirmationResult = await signInWithPhoneNumber(auth, lastPhoneNumber, verifier);
      loading.classList.remove('active');
      const s = document.getElementById('otpSuccess');
      s.textContent = 'OTP resent!';
      s.style.display = 'block';
      setTimeout(() => s.style.display = 'none', 2000);
    } catch (e) {
      loading.classList.remove('active');
      showError('otpError', 'Resend failed.');
    }
  };

  // === FORM SUBMISSIONS ===
  document.getElementById('loginForm').onsubmit = e => {
    e.preventDefault();
    const mobile = document.getElementById('loginMobile').value.trim();
    const code = document.getElementById('loginCountryCode').value;
    if (/^\d{7,15}$/.test(mobile)) sendOTP(mobile, code, 'loginModal', 'loginError');
    else showError('loginError', 'Invalid number.');
  };

  document.getElementById('signupForm').onsubmit = e => {
    e.preventDefault();
    const name = document.getElementById('signupName').value.trim();
    const mobile = document.getElementById('signupMobile').value.trim();
    const code = document.getElementById('signupCountryCode').value;
    if (name && /^\d{7,15}$/.test(mobile)) sendOTP(mobile, code, 'signupModal', 'signupError');
    else showError('signupError', 'Fill name and valid number.');
  };

  // === OTP INPUT NAVIGATION ===
  document.querySelectorAll('.otp-input').forEach((inp, i) => {
    inp.oninput = () => {
      if (inp.value) { inp.classList.add('filled'); if (i < 5) document.querySelector(`[data-index="${i+1}"]`).focus(); }
      else inp.classList.remove('filled');
    };
    inp.onkeydown = e => { if (e.key === 'Backspace' && !inp.value && i > 0) document.querySelector(`[data-index="${i-1}"]`).focus(); };
  });

  // === CLOSE ON BACKDROP ===
  document.querySelectorAll('.modal-overlay').forEach(m => m.onclick = e => { if (e.target === m) closeModal(m.id); });
</script>
</body>
</html>